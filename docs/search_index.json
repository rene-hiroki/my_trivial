[
["index.html", "æ—¥ã€…ã®é›‘å­¦ ã¯ã˜ã‚ã« 0.1 ç’°å¢ƒ", " æ—¥ã€…ã®é›‘å­¦ Akiyama Hiroki æœ€çµ‚æ›´æ–°æ—¥: 2020-05-20 ã¯ã˜ã‚ã« ä½œæˆä¸­ã§ã™ hogehoge fugafuga 0.1 ç’°å¢ƒ sessionInfo() ## R version 3.6.3 (2020-02-29) ## Platform: x86_64-w64-mingw32/x64 (64-bit) ## Running under: Windows 10 x64 (build 18363) ## ## Matrix products: default ## ## locale: ## [1] LC_COLLATE=Japanese_Japan.932 LC_CTYPE=Japanese_Japan.932 LC_MONETARY=Japanese_Japan.932 LC_NUMERIC=C ## [5] LC_TIME=Japanese_Japan.932 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] stringi_1.4.6 leaflet_2.0.3 ggmap_3.0.0 DT_0.13 lubridate_1.7.8 jsonlite_1.6.1 ## [7] bookdown_0.18 patchwork_1.0.0 imager_0.42.3 magrittr_1.5 tictoc_1.0 microbenchmark_1.4-7 ## [13] xgboost_1.0.0.2 furrr_0.1.0 future_1.16.0 yardstick_0.0.6 workflows_0.1.1 tune_0.1.0 ## [19] rsample_0.0.6 recipes_0.1.10 parsnip_0.1.0 infer_0.5.1 dials_0.0.6 scales_1.1.0 ## [25] broom_0.5.5 tidymodels_0.1.0 forcats_0.5.0 stringr_1.4.0 dplyr_0.8.5 purrr_0.3.3 ## [31] readr_1.3.1 tidyr_1.0.2 tibble_3.0.0 ggplot2_3.3.0 tidyverse_1.3.0 here_0.1 ## ## loaded via a namespace (and not attached): ## [1] pacman_0.5.1 utf8_1.1.4 tidyselect_1.0.0 lme4_1.1-21 htmlwidgets_1.5.1 grid_3.6.3 ## [7] ranger_0.12.1 pROC_1.16.2 munsell_0.5.0 codetools_0.2-16 miniUI_0.1.1.1 withr_2.1.2 ## [13] colorspace_1.4-1 knitr_1.28 rstudioapi_0.11 stats4_3.6.3 bayesplot_1.7.1 listenv_0.8.0 ## [19] labeling_0.3 rstan_2.19.3 RgoogleMaps_1.4.5.3 DiceDesign_1.8-1 farver_2.0.3 rprojroot_1.3-2 ## [25] vctrs_0.2.99.9011 generics_0.0.2 TH.data_1.0-10 ipred_0.9-9 xfun_0.12 R6_2.4.1 ## [31] markdown_1.1 rstanarm_2.19.3 bitops_1.0-6 lhs_1.0.1 assertthat_0.2.1 promises_1.1.0 ## [37] multcomp_1.4-13 nnet_7.3-13 gtable_0.3.0 globals_0.12.5 bmp_0.3 processx_3.4.2 ## [43] sandwich_2.5-1 timeDate_3043.102 rlang_0.4.6 splines_3.6.3 ModelMetrics_1.2.2.2 inline_0.3.15 ## [49] yaml_2.2.1 reshape2_1.4.3 modelr_0.1.6 tidytext_0.2.3 threejs_0.3.3 crosstalk_1.1.0.1 ## [55] backports_1.1.6 httpuv_1.5.2 rsconnect_0.8.16 tokenizers_0.2.1 caret_6.0-86 tools_3.6.3 ## [61] lava_1.6.7 ellipsis_0.3.0 ggridges_0.5.2 Rcpp_1.0.4.6 plyr_1.8.6 base64enc_0.1-3 ## [67] ps_1.3.2 prettyunits_1.1.1 rpart_4.1-15 zoo_1.8-7 haven_2.2.0 fs_1.4.1 ## [73] data.table_1.12.8 readbitmap_0.1.5 colourpicker_1.0 reprex_0.3.0 GPfit_1.0-8 mvtnorm_1.1-0 ## [79] SnowballC_0.7.0 packrat_0.5.0 matrixStats_0.56.0 tidyposterior_0.0.2 hms_0.5.3 shinyjs_1.1 ## [85] mime_0.9 evaluate_0.14 xtable_1.8-4 tidypredict_0.4.5 shinystan_2.5.0 jpeg_0.1-8.1 ## [91] readxl_1.3.1 gridExtra_2.3 rstantools_2.0.0 compiler_3.6.3 crayon_1.3.4 minqa_1.2.4 ## [97] StanHeaders_2.21.0-1 htmltools_0.4.0 later_1.0.0 tiff_0.1-5 DBI_1.1.0 dbplyr_1.4.2 ## [103] MASS_7.3-51.5 boot_1.3-24 Matrix_1.2-18 cli_2.0.2 parallel_3.6.3 gower_0.2.1 ## [109] igraph_1.2.5 pkgconfig_2.0.3 sp_1.4-1 xml2_1.3.1 foreach_1.5.0 dygraphs_1.1.1.6 ## [115] hardhat_0.1.2 prodlim_2019.11.13 rvest_0.3.5 janeaustenr_0.1.5 callr_3.4.3 digest_0.6.25 ## [121] rmarkdown_2.1 cellranger_1.1.0 shiny_1.4.0.2 gtools_3.8.2 rjson_0.2.20 nloptr_1.2.2.1 ## [127] lifecycle_0.2.0 nlme_3.1-145 fansi_0.4.1 pillar_1.4.3 lattice_0.20-41 loo_2.2.0 ## [133] fastmap_1.0.1 httr_1.4.1 pkgbuild_1.0.6 survival_3.1-11 glue_1.4.0 xts_0.12-0 ## [139] png_0.1-7 shinythemes_1.1.2 iterators_1.0.12 class_7.3-16 e1071_1.7-3 "],
["01_android_analysis.html", "Chapter: 1 androidåˆ†æ 1.1 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æº–å‚™ 1.2 activityã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ 1.3 ã“ã“ã‹ã‚‰è§£æ", " Chapter: 1 androidåˆ†æ 1.1 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æº–å‚™ pacman::p_loadã‚’ä½¿ã†ã¨ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã¾ã¨ã‚ã¦èª­ã¿è¾¼ã‚“ã§ãã‚Œã¾ã™ã€‚ã¾ãŸã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚ã‚‹å ´åˆã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‹ã¤èª­ã¿è¾¼ã¿ã‚’è¡Œã£ã¦ãã‚Œã¾ã™ã€‚ pacmanãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚ # install.packages(pacman) pacman::p_load(tidyverse, jsonlite, patchwork, here, lubridate, update = FALSE) 1.2 activityã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ ã‚ã¨ã§æ›¸ã google takeout ã§æ¤œç´¢ 1.3 ã“ã“ã‹ã‚‰è§£æ 1.3.1 activityã®èª­ã¿è¾¼ã¿ android &lt;- jsonlite::fromJSON(here(&quot;data/android_activity.json&quot;)) 1.3.2 èª­ã¿è¾¼ã‚“ã activityãƒ‡ãƒ¼ã‚¿ã®æ¦‚è¦ç¢ºèª glimpse(android) ## Rows: 63,120 ## Columns: 5 ## $ header [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;ã³ã‚ˆãƒ¼ã‚“ã£ãŸãƒ¼ Pro&quot;, &quot;Nova Launcher ãƒ›ãƒ¼ãƒ &quot;, &quot;Gmail&quot;, &quot;Slack&quot;, &quot;Nova Launcher ãƒ›ãƒ¼ãƒ &quot;, &quot;com.android.systemui&quot;, &quot;LINEï¼ˆãƒ©ã‚¤ãƒ³ï¼‰ - ç„¡æ–™é€šè©±ãƒ»ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ—ãƒª&quot;, &quot;ã³... ## $ title [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;ä½¿ç”¨: ã³ã‚ˆãƒ¼ã‚“ã£ãŸãƒ¼ Pro&quot;, &quot;ä½¿ç”¨: Nova Launcher ãƒ›ãƒ¼ãƒ &quot;, &quot;ä½¿ç”¨: Gmail&quot;, &quot;ä½¿ç”¨: Slack&quot;, &quot;ä½¿ç”¨: Nova Launcher ãƒ›ãƒ¼ãƒ &quot;, &quot;ä½¿ç”¨: com.android.systemui&quot;, &quot;ä½¿ç”¨: ... ## $ titleUrl [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;https://play.google.com/store/apps/details?id=com.ABS104a.biyontterpro&quot;, &quot;https://play.google.com/store/apps/details?id=com.tes... ## $ time [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;2020-04-16T21:29:57.048Z&quot;, &quot;2020-04-16T21:29:54.832Z&quot;, &quot;2020-04-16T21:29:28.111Z&quot;, &quot;2020-04-16T21:27:42.460Z&quot;, &quot;2020-04-16T14:2... ## $ products [3m[38;5;246m&lt;list&gt;[39m[23m [&quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Android&quot;, &quot;Andr... 1.3.3 timeãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ› android &lt;- android %&gt;% mutate(time = parse_datetime(time, locale = locale(tz = &quot;Japan&quot;)) ) %&gt;% mutate(date = lubridate::date(time), year = lubridate::year(time)) 1.3.4 å¹´æœˆã”ã¨ã®ãƒ‡ãƒ¼ã‚¿æ•°ã®é›†è¨ˆ 2018å¹´8æœˆä»¥å‰ã®ãƒ‡ãƒ¼ã‚¿ãŒå°‘ãªã„ã€‚ activityãƒ‡ãƒ¼ã‚¿ã®åé›†ãŒã†ã¾ãã„ã£ã¦ã„ãªã‹ã£ãŸï¼Ÿ android %&gt;% group_by(year, month(date)) %&gt;% count() ## # A tibble: 37 x 3 ## # Groups: year, month(date) [37] ## year `month(date)` n ## &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; ## 1 2016 12 2 ## 2 2017 1 1 ## 3 2017 2 56 ## 4 2017 3 26 ## 5 2017 5 6 ## 6 2017 6 64 ## 7 2017 7 12 ## 8 2017 8 29 ## 9 2017 9 32 ## 10 2017 11 4 ## # ... with 27 more rows android %&gt;% count(date) %&gt;% ggplot() + geom_line(aes(date,n)) + scale_x_date(breaks = &quot;month&quot;, guide = guide_axis(n.dodge = 3)) 1.3.5 ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ 2019å¹´ã¨2020å¹´ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’ä½¿ã†ã“ã¨ã«ã™ã‚‹ã€‚ android_latest &lt;- android %&gt;% filter(year %in% c(2019, 2020)) ã‚¢ãƒ—ãƒªã®åå‰ãŒé•·ã„ã‹ã‚‰20æ–‡å­—ã¾ã§ã«ã™ã‚‹ã€‚ android_latest &lt;- android_latest %&gt;% mutate(header = if_else(str_length(header) &gt;= 20, substr(header, 1, 20), header)) android &lt;- android %&gt;% mutate(header = if_else(str_length(header) &gt;= 20, substr(header, 1, 20), header)) 1.3.6 ã‚¢ãƒ—ãƒªã®ä½¿ç”¨å›æ•°ï¼ˆ2019-2020ï¼‰ android_latest %&gt;% count(header, sort = TRUE) %&gt;% head(5) %&gt;% mutate(header = fct_reorder(header, n)) %&gt;% ggplot() + geom_col(aes(y = header, x = n)) + theme_minimal() + labs(title = &quot;Most used Apps - Overall&quot;, subtitle = &quot;Android Smartphone usage&quot;, caption = &quot;Data:Google Takeout&quot;) 1.3.7 ã‚¢ãƒ—ãƒªã®ä½¿ç”¨å›æ•°ï¼ˆã™ã¹ã¦ã®å¹´ï¼‰ android %&gt;% count(header, sort = TRUE) %&gt;% head(5) %&gt;% mutate(header = fct_reorder(header, n)) %&gt;% ggplot() + geom_col(aes(y = header, x = n)) + theme_minimal() + labs(title = &quot;Most used Apps - Overall&quot;, subtitle = &quot;Android Smartphone usage&quot;, caption = &quot;Data:Google Takeout&quot;) 1.3.8 æ¯”è¼ƒï¼ˆ2019 vs 2020ï¼‰ android_latest %&gt;% filter(year %in% &#39;2019&#39;) %&gt;% group_by(year, header) %&gt;% summarise(n = n()) %&gt;% arrange(desc(n)) %&gt;% head(5) %&gt;% #View() mutate(header = fct_reorder(header, n)) %&gt;% ggplot() + geom_col(aes(y = header, x = n)) + # facet_wrap(~year, scales = &quot;free&quot;) + theme_minimal() + labs(title = &quot;Most used Apps - 2019&quot;, subtitle = &quot;Android Smartphone usage&quot;, caption = &quot;Data:Google Takeout&quot;) -&gt; p2019 android_latest %&gt;% filter(year %in% &#39;2020&#39;) %&gt;% group_by(year, header) %&gt;% summarise(n = n()) %&gt;% arrange(desc(n)) %&gt;% head(5) %&gt;% #View() mutate(header = fct_reorder(header, n)) %&gt;% ggplot() + geom_col(aes(y = header, x = n)) + # facet_wrap(~year, scales = &quot;free&quot;) + theme_minimal() + labs(title = &quot;Most used Apps - 2020&quot;, subtitle = &quot;Android Smartphone usage&quot;, caption = &quot;Data:Google Takeout&quot;) -&gt; p2020 p2019 / p2020 "],
["02_standard_input.html", "Chapter: 2 æ¨™æº–å…¥åŠ› 2.1 readLines 2.2 ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è¨ˆç®—å‡¦ç† 2.3 ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¾ã›ã‚‹", " Chapter: 2 æ¨™æº–å…¥åŠ› æ¨™æº–å…¥åŠ›ã€ã¤ã¾ã‚Šã¯Pythonã§è¨€ã†ã¨ã“ã‚ã®input()ã‚’Rã§ã‚„ã‚ã†ã¨ã—ãŸã‚‰ã€ã‹ãªã‚Šè‹¦åŠ´ã—ãŸã®ã§tipsã¨ã—ã¦ã¾ã¨ã‚ã¦ãŠãã“ã¨ã«ã—ãŸã€‚ 2.1 readLines ãšã°ã‚ŠRã§æ¨™æº–å…¥åŠ›ã‚’ã™ã‚‹ã«ã¯readLinesã‚’ä½¿ã†ã€‚ãŸã ã—ã€ input_lines &lt;- readLines(&quot;stdin&quot;) ã“ã®ã‚ˆã†ã«\"stdin\"ã¨ã„ã†å¼•æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã€‚ãŠãã‚‰ãstandard input ã®ç•¥ã‹ä½•ã‹ã ã‚ã†ã€‚ æ³¨æ„ã™ã¹ãã¯ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’Rã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œã—ã¦ã—ã¾ã†ã¨RãŒã†ã‚“ã¨ã‚‚ã™ã‚“ã¨ã‚‚è¨€ã‚ãªããªã£ã¦ã—ã¾ã†ã“ã¨ã€‚ è©³ã—ã„ç†ç”±ã¯ã‚ã‹ã‚‰ãªã„ãŒã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰ã®æ¨™æº–å…¥åŠ›ã‚’å—ã‘ã‚‹ã‚ˆã†ã«æŒ‡ç¤ºã—ã¦ã„ã‚‹ã®ã§ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œã—ã¦ã—ã¾ã†ã¨ãƒ€ãƒ¡ã€ã¨ã„ã†ã“ã¨ãªã®ã ã‚ã†ã‹ï¼ˆèª°ã‹æ•™ãˆã¦æ¬²ã—ã„ï¼‰ã€‚ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã§å®Ÿé¨“çš„ã«ã‚³ãƒ¼ãƒ‰ã‚’è©¦ã—ãŸã„å ´åˆã¯ã€readline()ã‚’ä½¿ãˆã°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å…¥åŠ›å¾…ã¡çŠ¶æ…‹ã¨ãªã‚‹ã®ã§ã€ã“ã¡ã‚‰ã‚’ä½¿ç”¨ã™ã‚‹ã€‚ ãŸã¨ãˆã°stdin.Rã«ä¸‹è¨˜ã®ã‚ˆã†ã«è¨˜è¿°ã—ã¦ãŠãã€ #! /usr/bin/env Rscript input_lines &lt;- readLines(&quot;stdin&quot;) cat(input_lines[1]) # catã¯æ¨™æº–å‡ºåŠ› ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰ä¸‹è¨˜ã®ã‚ˆã†ã«ã—ã¦stdin.Rã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ Rscript stdin.R ã™ã‚‹ã¨å…¥åŠ›å¾…ã¡çŠ¶æ…‹ã«ãªã‚‹ã®ã§ã€ä½•ã‹ã—ã‚‰è¨˜è¿°ã™ã‚‹ã€‚ Hello world! ãã—ã¦ã€ctrl + cã‚ã‚‹ã„ã¯ctrl + zã®å¾Œã«Enterã§å…¥åŠ›ã‚’çµ‚äº†ã™ã‚‹ã¨ï¼ˆä»–ã®æ–¹æ³•ã‚ã‚Šã¾ã™ã‹ï¼Ÿï¼‰ Hello world! ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«æ¨™æº–å‡ºåŠ›ãŒã§ãã‚‹ã€‚ 2.2 ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è¨ˆç®—å‡¦ç† stdin.Rã«ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°ã—ã¦ãŠã‘ã°ã€æ¨™æº–å…¥åŠ›ã§å—ã‘å–ã£ãŸå€¤ã‚’ã€è¨ˆç®—å‡¦ç†ã‚’ã—ã¦ã‹ã‚‰è¿”ã™ã“ã¨ã‚‚ã§ãã‚‹ã€‚ #! /usr/bin/env Rscript # ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚ã¤ã‹ãˆã‚‹ library(tidyverse) input_lines &lt;- readLines(&quot;stdin&quot;) x = as.integer(input_lines[1]) # 1ã¤ã‚ï¼ˆ1è¡Œç›®ã®å…¥åŠ›ï¼‰ y = as.integer(input_lines[2]) # 2ã¤ã‚ cat(x + y) 2.3 ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¾ã›ã‚‹ read_text.txtã‚’åˆ¥ã«ä»¥ä¸‹ã®ã‚ˆã†ã«æº–å‚™ã—ã¦ãŠãã€ ï¼ˆread_text.txtã®æœ€çµ‚è¡Œã«ã¯æ”¹è¡Œã‚’å…¥ã‚Œãªã„ã¨ã€ã‚ã¨ã§warningãŒå‡ºã‚‹ã®ã§æ³¨æ„ã™ã‚‹ã€‚ï¼‰ Hello world! stdin.Rã‚’ã“ã†ã—ã¦ãŠã #! /usr/bin/env Rscript input_lines &lt;- readLines(&quot;stdin&quot;) x = input_lines[1] y = input_lines[2] cat(x, y) ãã—ã¦ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ¬¡ã®ã‚ˆã†ã«ã™ã‚Œã°ã€read_text.txtã‹ã‚‰æ¨™æº–å…¥åŠ›ã‚’å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ Rscript stdin.R &lt; read_text.txt ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å‡ºåŠ›ã¯ã“ã†ãªã‚‹ Hello world! ã“ã‚Œã§atcoderã«ã‚‚å‚æˆ¦ã§ãã‚‹ï¼ ï¼ˆatcoderã§Rã¯ä½¿ç”¨ä¸å¯ã€ã€ã€ï¼‰ "],
["03_ido_keido.html", "Chapter: 3 ç·¯åº¦çµŒåº¦ã‹ã‚‰ã¡ã‚‡ã£ã¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªåœ°å›³ä½œæˆ 3.1 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ 3.2 ãƒ‡ãƒ¼ã‚¿æº–å‚™ 3.3 ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®æ–‡å­—ä½œæˆ 3.4 ãƒãƒ¼ã‚«ãƒ¼ãƒªã‚¹ãƒˆ 3.5 åœ°å›³ã«ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ 3.6 ãƒ‡ãƒ¼ã‚¿ä¸€è¦§ 3.7 ãƒãƒ¼ã‚«ãƒ¼ãƒªã‚¹ãƒˆ 3.8 åœ°å›³ã«ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ãã®ï¼’", " Chapter: 3 ç·¯åº¦çµŒåº¦ã‹ã‚‰ã¡ã‚‡ã£ã¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªåœ°å›³ä½œæˆ å‚è€ƒã«ã—ãŸè¨˜äº‹ ã¨ã„ã†ã‹ã»ã¼ã“ã‚Œ https://rpubs.com/kazutan/jssp2015_leaflet 3.1 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ library(tidyverse) library(here) library(DT) # è¡¨ä½œæˆç”¨ library(ggmap) # ä½æ‰€ãƒ»ç·¯åº¦çµŒåº¦å¯¾å¿œç”¨ library(leaflet) # ãƒ—ãƒ­ãƒƒãƒˆç”¨ library(stringi) # å…¨è§’ã‹ã‚‰åŠè§’å¤‰æ› 3.2 ãƒ‡ãƒ¼ã‚¿æº–å‚™ ç·¯åº¦çµŒåº¦å–å¾—å¾Œã®æƒ³å®šãƒ‡ãƒ¼ã‚¿ # æ±äº¬ãƒ‰ãƒ¼ãƒ  æ—¥æœ¬ã€ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½ï¼‘ä¸ç›®ï¼“âˆ’ï¼–ï¼‘ 35.7056396 139.7518913 # ç¦å³¶è–å¤©é€šå•†åº—è¡— æ—¥æœ¬ã€ã€’553-0003 å¤§é˜ªåºœå¤§é˜ªå¸‚ç¦å³¶åŒºç¦å³¶ï¼—ä¸ç›®ï¼—âˆ’ï¼‘ï¼’ 34.6976052 135.4846712 # éŠ€åº§é€šã‚Šå•†åº—è¡— æ—¥æœ¬ã€ã€’489-0043 æ„›çŸ¥çœŒç€¬æˆ¸å¸‚æœæ—¥ç”º 35.2266746 137.100508 df &lt;- tribble( ~id, ~lat, ~lon, ~address, ~group, ~name, 1, 35.7056396, 139.7518913,&quot;ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½ï¼‘ä¸ç›®ï¼“âˆ’ï¼–ï¼‘&quot;, &quot;ã‚¹ãƒãƒ¼ãƒ„&quot;, &quot;æ±äº¬ãƒ‰ãƒ¼ãƒ &quot;, 2, 34.6976052, 135.4846712,&quot;ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½ï¼‘ä¸ç›®ï¼“âˆ’ï¼–ï¼‘&quot;, &quot;å•†åº—è¡—A&quot; ,&quot;ç¦å³¶è–å¤©é€šå•†åº—è¡—&quot;, 3, 35.2266746, 137.100508,&quot;ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½ï¼‘ä¸ç›®ï¼“âˆ’ï¼–ï¼‘&quot;, &quot;å•†åº—è¡—B&quot;, &quot;éŠ€åº§é€šã‚Šå•†åº—è¡—&quot; ) # https://www.pediatricsurgery.site/entry/2017/10/12/105242 df &lt;- df %&gt;% mutate(address = stri_trans_nfkc(address)) # ä½æ‰€ã®å…¨è§’ã‚’åŠè§’ã«å¤‰æ› df ## # A tibble: 3 x 6 ## id lat lon address group name ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 1 35.7 140. ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61 ã‚¹ãƒãƒ¼ãƒ„ æ±äº¬ãƒ‰ãƒ¼ãƒ  ## 2 2 34.7 135. ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61 å•†åº—è¡—A ç¦å³¶è–å¤©é€šå•†åº—è¡— ## 3 3 35.2 137. ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61 å•†åº—è¡—B éŠ€åº§é€šã‚Šå•†åº—è¡— 3.3 ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®æ–‡å­—ä½œæˆ df &lt;- df %&gt;% mutate(popup = paste(name, group, address, sep=&quot;&lt;br/&gt;&quot;)) df ## # A tibble: 3 x 7 ## id lat lon address group name popup ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 1 35.7 140. ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61 ã‚¹ãƒãƒ¼ãƒ„ æ±äº¬ãƒ‰ãƒ¼ãƒ  æ±äº¬ãƒ‰ãƒ¼ãƒ &lt;br/&gt;ã‚¹ãƒãƒ¼ãƒ„&lt;br/&gt;ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61 ## 2 2 34.7 135. ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61 å•†åº—è¡—A ç¦å³¶è–å¤©é€šå•†åº—è¡— ç¦å³¶è–å¤©é€šå•†åº—è¡—&lt;br/&gt;å•†åº—è¡—A&lt;br/&gt;ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61~ ## 3 3 35.2 137. ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61 å•†åº—è¡—B éŠ€åº§é€šã‚Šå•†åº—è¡— éŠ€åº§é€šã‚Šå•†åº—è¡—&lt;br/&gt;å•†åº—è¡—B&lt;br/&gt;ã€’112-0004 æ±äº¬éƒ½æ–‡äº¬åŒºå¾Œæ¥½1ä¸ç›®3-61 3.4 ãƒãƒ¼ã‚«ãƒ¼ãƒªã‚¹ãƒˆ icon_df &lt;- tibble(group = df$group, icon = paste0(here(&quot;picture/icon/&quot;), &quot;/&quot;,dir(here(&quot;picture/icon/&quot;))[1:3])) icon_df ## # A tibble: 3 x 2 ## group icon ## &lt;chr&gt; &lt;chr&gt; ## 1 ã‚¹ãƒãƒ¼ãƒ„ C:/Users/AkiyamaHiroki/Desktop/my_trivial/picture/icon/marker-icon-2x-black.png ## 2 å•†åº—è¡—A C:/Users/AkiyamaHiroki/Desktop/my_trivial/picture/icon/marker-icon-2x-blue.png ## 3 å•†åº—è¡—B C:/Users/AkiyamaHiroki/Desktop/my_trivial/picture/icon/marker-icon-2x-gold.png 3.5 åœ°å›³ã«ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ # iconã®é«˜ã•ã¨å¹… w &lt;- 20 h &lt;- 30 geo &lt;- df %&gt;% leaflet() %&gt;% addTiles() for (gru in df$group){ icon_list &lt;- icons(iconUrl = icon_df %&gt;% filter(group == gru) %&gt;% pull(icon), iconWidth = w, iconHeight = h, iconAnchorX = w/2, iconAnchorY = h) geo &lt;- geo %&gt;% addMarkers(lng = ~lon, lat = ~lat, popup = ~popup, group = gru, icon = icon_list, data = dplyr::filter(.data = df, group == gru)) %&gt;% addLayersControl(overlayGroups = df$group, options = layersControlOptions(collapsed = FALSE)) } geo 3.6 ãƒ‡ãƒ¼ã‚¿ä¸€è¦§ # ä¸€è¦§è¡¨ç¤º DT::datatable(dplyr::select(df,name:group),options = list(searchHighlight = TRUE), filter = &#39;top&#39;) 3.7 ãƒãƒ¼ã‚«ãƒ¼ãƒªã‚¹ãƒˆ icon_df &lt;- tibble(group = unique(df$group), icon = paste0(here(&quot;picture/icon/&quot;), &quot;/&quot;,dir(here(&quot;picture/icon/&quot;))[1:3])) icon_df ## # A tibble: 3 x 2 ## group icon ## &lt;chr&gt; &lt;chr&gt; ## 1 ã‚¹ãƒãƒ¼ãƒ„ C:/Users/AkiyamaHiroki/Desktop/my_trivial/picture/icon/marker-icon-2x-black.png ## 2 å•†åº—è¡—A C:/Users/AkiyamaHiroki/Desktop/my_trivial/picture/icon/marker-icon-2x-blue.png ## 3 å•†åº—è¡—B C:/Users/AkiyamaHiroki/Desktop/my_trivial/picture/icon/marker-icon-2x-gold.png 3.8 åœ°å›³ã«ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ãã®ï¼’ # iconã®é«˜ã•ã¨å¹… # w &lt;- 20 # h &lt;- 30 # geo &lt;- df %&gt;% leaflet() %&gt;% addTiles() # # for (gru in unique(df$group)){ # # icon_list &lt;- icons(iconUrl = icon_df %&gt;% filter(group == gru) %&gt;% pull(icon), # iconWidth = w, iconHeight = h, # iconAnchorX = w/2, iconAnchorY = h) # # geo &lt;- geo %&gt;% # addMarkers(lng = ~lon, lat = ~lat, popup = ~popup, group = gru, # icon = icon_list, # data = dplyr::filter(.data = df, group == gru)) %&gt;% # addLayersControl(overlayGroups = unique(df$group), # options = layersControlOptions(collapsed = FALSE)) # } # geo "],
["04_img_classfication.html", "Chapter: 4 ç”»åƒå‡¦ç†ã¨å¤šã‚¯ãƒ©ã‚¹åˆ†é¡ 4.1 æ¦‚è¦èª¬æ˜ 4.2 çµæœ 4.3 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ 4.4 ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ 4.5 ã€Œã‚ã„ã†ãˆãŠã€ã‚’è¦‹ã¦ã¿ã‚‹ 4.6 å‰å‡¦ç† 4.7 ãƒ¢ãƒ‡ãƒªãƒ³ã‚° 4.8 è¨ˆæ¸¬", " Chapter: 4 ç”»åƒå‡¦ç†ã¨å¤šã‚¯ãƒ©ã‚¹åˆ†é¡ 4.1 æ¦‚è¦èª¬æ˜ ã‚ã¨ã§æ›¸ã 4.2 çµæœ ã‚ã¨ã§æ›¸ã 4.3 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ library(here) # file path library(tidyverse) # handling library(tidymodels) # modeling library(furrr) # parallel library(xgboost) # modeling xgboost library(microbenchmark) # time check library(tictoc) # time check library(imager) # image processing library(patchwork) # plot 4.4 ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ 22ç§’ãã‚‰ã„ã‹ã‹ã‚‹ã€‚ tic() path_vec &lt;- here(paste0(&quot;data/hiragana/&quot;, 1:6069, &quot;.png&quot;)) data &lt;- path_vec %&gt;% map(load.image) %&gt;% tibble(images = .) toc() ## 15.13 sec elapsed 4.5 ã€Œã‚ã„ã†ãˆãŠã€ã‚’è¦‹ã¦ã¿ã‚‹ data$images[1:5] %&gt;% map(plot) ## [[1]] ## Image. Width: 72 pix Height: 76 pix Depth: 1 Colour channels: 1 ## ## [[2]] ## Image. Width: 72 pix Height: 76 pix Depth: 1 Colour channels: 1 ## ## [[3]] ## Image. Width: 72 pix Height: 76 pix Depth: 1 Colour channels: 1 ## ## [[4]] ## Image. Width: 72 pix Height: 76 pix Depth: 1 Colour channels: 1 ## ## [[5]] ## Image. Width: 72 pix Height: 76 pix Depth: 1 Colour channels: 1 4.6 å‰å‡¦ç† ä½™è¨ˆãªéƒ¨åˆ†ã‚’å‰Šã‚‹ã€‚ æ¨ªã¯20ï½50ã¾ã§ã€ç¸¦ã¯20ï½60ã¾ã§ã€‚ preprocessing &lt;- function(img){ mat &lt;- img %&gt;% as.matrix() mat_reshape_img &lt;- mat[20:50, 20:60] %&gt;% as.cimg() mat_reshape_img } data &lt;- data %&gt;% mutate(processed = map(images, preprocessing)) data$processed[[1]] %&gt;% plot ç”»åƒã‚’ä¸€æ¬¡å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã™ã‚‹ã€‚ æ­£è§£ã®ãƒ©ãƒ™ãƒ«ã‚’ã¤ã‘ã‚‹ã€‚ ã‚è¡Œã®ã€Œã„ã€ã¨ã€Œã†ã€ã¨ã€Œãˆã€ã€ã¯ã€Œã„2ã€ã€Œã†2ã€ã€Œãˆ2ã€ æ—§æ–‡å­—ã®ã€Œã„ã€ã¨ã€Œãˆã€ã¯ã€Œã„3ã€ã€Œãˆ3ã€ã¨ã—ãŸã€‚ s &lt;- str_c(&quot;ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ãªã«ã¬ã­ã®ã¯ã²ãµã¸ã»ã¾ã¿ã‚€ã‚ã‚‚&quot;) s &lt;- str_split(s, pattern = &quot;&quot;)[[1]] s &lt;- c(s ,&quot;ã‚„&quot;,&quot;ã„2&quot;,&quot;ã‚†&quot;,&quot;ãˆ2&quot;,&quot;ã‚ˆ&quot;,&quot;ã‚‰&quot;,&quot;ã‚Š&quot;,&quot;ã‚‹&quot;,&quot;ã‚Œ&quot;,&quot;ã‚&quot;,&quot;ã‚&quot;,&quot;ã„3&quot;,&quot;ã†2&quot;,&quot;ãˆ3&quot;,&quot;ã‚’&quot;,&quot;ã‚“&quot;) data &lt;- data %&gt;% mutate(vec_img = processed %&gt;% map(as.vector)) %&gt;% mutate(label = rep(s, 119)) # ãã‚Œãã‚Œ119æ–‡å­—ãšã¤ã‚ã‚‹ã€‚ data %&gt;% head() ## # A tibble: 6 x 4 ## images processed vec_img label ## &lt;list&gt; &lt;list&gt; &lt;list&gt; &lt;chr&gt; ## 1 &lt;cimg&gt; &lt;cimg&gt; &lt;dbl [1,271]&gt; ã‚ ## 2 &lt;cimg&gt; &lt;cimg&gt; &lt;dbl [1,271]&gt; ã„ ## 3 &lt;cimg&gt; &lt;cimg&gt; &lt;dbl [1,271]&gt; ã† ## 4 &lt;cimg&gt; &lt;cimg&gt; &lt;dbl [1,271]&gt; ãˆ ## 5 &lt;cimg&gt; &lt;cimg&gt; &lt;dbl [1,271]&gt; ãŠ ## 6 &lt;cimg&gt; &lt;cimg&gt; &lt;dbl [1,271]&gt; ã‹ make_data &lt;- function(data, start, end){ d &lt;- data %&gt;% filter(label %in% s[start:end]) %&gt;% select(-images, -processed) tic() cols &lt;- paste0(&quot;pixel&quot;, 1:1271) res &lt;- d$vec_img[[1]] names(res) &lt;- cols for (i in 2:(nrow(d))) { tmp &lt;- d$vec_img[[i]] names(tmp) &lt;- cols res &lt;- res %&gt;% bind_rows(tmp) } res &lt;- res %&gt;% mutate(label = as.factor(d$label)) toc() return(res) } # 3300ç§’ãã‚‰ã„ã‹ã‹ã‚‹ # res_51 &lt;- make_data(data,1,51) # ä¸€åº¦èª­ã¿è¾¼ã‚“ã ã‚‚ã®ã‚’rdsã«ä¿å­˜ã—ã¦ãŠã„ãŸ res_51 &lt;- read_rds(here(&quot;data/res_51.rds&quot;)) res_2 &lt;- res_51 %&gt;% filter(label %in% s[1:2]) %&gt;% mutate(label = as.factor(label)) res_10 &lt;- res_51 %&gt;% filter(label %in% s[1:10]) %&gt;% mutate(label = as.factor(label)) res_30 &lt;- res_51 %&gt;% filter(label %in% s[1:30]) %&gt;% mutate(label = as.factor(label)) 4.7 ãƒ¢ãƒ‡ãƒªãƒ³ã‚° 4.7.1 ãƒ‡ãƒ¼ã‚¿ã‚’train/testã«80%/20%ã§åˆ†å‰²ã™ã‚‹ set.seed(7777) splits &lt;- res_2 %&gt;% initial_split(prop = 0.8, strata = label) train &lt;- training(splits) test &lt;- testing(splits) 4.7.2 tidymodelsã®æº–å‚™ target_var &lt;- sym(&quot;label&quot;) # set target_var, sym means symbol mode &lt;- &quot;classification&quot; # set estimate type formula &lt;- expr(formula(!!target_var ~ .)) # set formura # set recipes rec &lt;- train %&gt;% recipe(formula = formula) rec_preped &lt;- prep(rec) 4.7.3 random forestã¨xgboostã®ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾© # random forest model_rf &lt;- rand_forest() %&gt;% set_engine(&quot;ranger&quot;) %&gt;% set_mode(mode) #boosted trees model_xgb &lt;- boost_tree() %&gt;% set_engine(&quot;xgboost&quot;) %&gt;% set_mode(mode) model_list &lt;- list(rf = model_rf, xgb = model_xgb) flow_list &lt;- workflow() %&gt;% add_recipe(rec) flow_list &lt;- map(.x = model_list, ~add_model(x = flow_list, spec = .x)) 4.8 è¨ˆæ¸¬ 4.8.1 è¨ˆæ¸¬ã™ã‚‹ï¼ˆï¼’æ–‡å­—ï¼‰ rfã¨xgboostãã‚Œãã‚Œ50å›ãšã¤fitã•ã›ã‚‹æ™‚é–“ã‚’è¨ˆæ¸¬ã™ã‚‹ baked_train &lt;- bake(rec,train) # random forest time_rf_2 &lt;- microbenchmark( fit_rf &lt;- fit(flow_list$rf, data = baked_train), times = 2 ) # xgboost time_xgb_2 &lt;- microbenchmark( fit_xgb &lt;- fit(flow_list$xgb, data = baked_train), times = 2 ) 4.8.2 è¨ˆæ¸¬çµæœï¼ˆï¼’æ–‡å­—ï¼‰ bind_rows(time_rf_2, time_xgb_2) ## Warning in bind_rows_(x, .id): Unequal factor levels: coercing to character ## Warning in bind_rows_(x, .id): binding character and factor vector, coercing into character vector ## Warning in bind_rows_(x, .id): binding character and factor vector, coercing into character vector ## Unit: seconds ## expr min lq mean median uq max neval ## fit_rf &lt;- fit(flow_list$rf, data = baked_train) 1.207564 1.207564 1.350436 1.350436 1.493308 1.493308 2 ## fit_xgb &lt;- fit(flow_list$xgb, data = baked_train) 1.202549 1.202549 1.207039 1.207039 1.211529 1.211529 2 my_plot &lt;- function(time_rf, time_xgb, bins=20){ tibble(rf = time_rf$time/1e+09, xgb = time_xgb$time/1e+09) %&gt;% pivot_longer(everything()) %&gt;% ggplot(aes(value)) + geom_histogram(bins = bins) + facet_wrap(vars(name), ncol = 1) } my_plot(time_rf_2, time_xgb_2, bins = 20) 4.8.3 äºˆæ¸¬çµæœï¼ˆï¼’æ–‡å­—ï¼‰ my_predict &lt;- function(){ fit_rf &lt;- fit(flow_list$rf, data = bake(rec, test)) pred_rf &lt;- predict(fit_rf, new_data = bake(rec, test)) pred_conf_rf &lt;- caret::confusionMatrix(pred_rf$.pred_class, test$label) fit_xgb &lt;- fit(flow_list$xgb, data = bake(rec, test)) pred_xgb &lt;- predict(fit_xgb, new_data = bake(rec, test)) pred_conf_xgb &lt;- caret::confusionMatrix(pred_xgb$.pred_class, test$label) return(list(rf = pred_conf_rf$table, xgb= pred_conf_xgb$table)) } my_predict() ## $rf ## Reference ## Prediction ã‚ ã„ ## ã‚ 23 0 ## ã„ 0 23 ## ## $xgb ## Reference ## Prediction ã‚ ã„ ## ã‚ 23 0 ## ã„ 0 23 4.8.4 è¨ˆæ¸¬ã™ã‚‹ï¼ˆï¼‘ï¼æ–‡å­—ï¼‰ rfã¨xgboostãã‚Œãã‚Œ50å›ãšã¤fitã•ã›ã‚‹æ™‚é–“ã‚’è¨ˆæ¸¬ã™ã‚‹ã€‚ ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆã«4åˆ†ãã‚‰ã„ã‹ã‹ã‚‹ã€‚ fitã«ã¯å…¨éƒ¨ã§11åˆ†ãã‚‰ã„ã€‚ # set recipes rec &lt;- train %&gt;% recipe(formula = formula) rec_preped &lt;- prep(rec) flow_list &lt;- workflow() %&gt;% add_recipe(rec) flow_list &lt;- map(.x = model_list, ~add_model(x = flow_list, spec = .x)) set.seed(7777) splits &lt;- res_10 %&gt;% initial_split(prop = 0.8, strata = label) ## Warning: Too little data to stratify. Unstratified resampling will be used. train &lt;- training(splits) test &lt;- testing(splits) baked_train &lt;- bake(rec,train) # random forest time_rf_10 &lt;- microbenchmark( fit_rf &lt;- fit(flow_list$rf, data = baked_train), times = 50 ) # xgboost time_xgb_10 &lt;- microbenchmark( fit_xgb &lt;- fit(flow_list$xgb, data = baked_train), times = 50 ) 4.8.5 è¨ˆæ¸¬çµæœï¼ˆï¼‘ï¼æ–‡å­—ï¼‰ bind_rows(time_rf_10, time_xgb_10) ## Warning in bind_rows_(x, .id): Unequal factor levels: coercing to character ## Warning in bind_rows_(x, .id): binding character and factor vector, coercing into character vector ## Warning in bind_rows_(x, .id): binding character and factor vector, coercing into character vector ## Unit: seconds ## expr min lq mean median uq max neval ## fit_rf &lt;- fit(flow_list$rf, data = baked_train) 3.02797 3.053799 3.313087 3.063390 3.095673 15.011433 50 ## fit_xgb &lt;- fit(flow_list$xgb, data = baked_train) 8.13080 8.285678 8.391799 8.312129 8.454143 9.271326 50 my_plot(time_rf_10, time_xgb_10, bins = 30) 4.8.6 äºˆæ¸¬çµæœï¼ˆï¼‘ï¼æ–‡å­—ï¼‰ my_predict() ## $rf ## Reference ## Prediction ã‚ ã„ ã† ãˆ ãŠ ã‹ ã ã ã‘ ã“ ## ã‚ 25 0 0 0 0 0 0 0 0 0 ## ã„ 0 25 0 0 0 0 0 0 0 0 ## ã† 0 0 15 0 0 0 0 0 0 0 ## ãˆ 0 0 0 23 0 0 0 0 0 0 ## ãŠ 0 0 0 0 19 0 0 0 0 0 ## ã‹ 0 0 0 0 0 21 0 0 0 0 ## ã 0 0 0 0 0 0 30 0 0 0 ## ã 0 0 0 0 0 0 0 26 0 0 ## ã‘ 0 0 0 0 0 0 0 0 23 0 ## ã“ 0 0 0 0 0 0 0 0 0 30 ## ## $xgb ## Reference ## Prediction ã‚ ã„ ã† ãˆ ãŠ ã‹ ã ã ã‘ ã“ ## ã‚ 25 0 0 0 0 0 0 0 0 0 ## ã„ 0 25 0 0 0 0 0 0 0 0 ## ã† 0 0 15 0 0 0 0 0 0 0 ## ãˆ 0 0 0 23 0 0 0 0 0 0 ## ãŠ 0 0 0 0 19 0 0 0 0 0 ## ã‹ 0 0 0 0 0 21 0 0 0 0 ## ã 0 0 0 0 0 0 30 0 0 0 ## ã 0 0 0 0 0 0 0 26 0 0 ## ã‘ 0 0 0 0 0 0 0 0 23 0 ## ã“ 0 0 0 0 0 0 0 0 0 30 4.8.7 è¨ˆæ¸¬ã™ã‚‹ï¼ˆï¼“ï¼æ–‡å­—ï¼‰ rfã¨xgboostãã‚Œãã‚Œ50å›ãšã¤fitã•ã›ã‚‹æ™‚é–“ã‚’è¨ˆæ¸¬ã™ã‚‹ã€‚ fitã«ã¯å…¨éƒ¨ã§åˆ†ãã‚‰ã„ã€‚ # set recipes rec &lt;- train %&gt;% recipe(formula = formula) rec_preped &lt;- prep(rec) flow_list &lt;- workflow() %&gt;% add_recipe(rec) flow_list &lt;- map(.x = model_list, ~add_model(x = flow_list, spec = .x)) set.seed(7777) splits &lt;- res_30 %&gt;% initial_split(prop = 0.8, strata = label) ## Warning: Too little data to stratify. Unstratified resampling will be used. train &lt;- training(splits) test &lt;- testing(splits) baked_train &lt;- bake(rec,train) # random forest time_rf_30 &lt;- microbenchmark( fit_rf &lt;- fit(flow_list$rf, data = baked_train), times = 50 ) # xgboost time_xgb_30 &lt;- microbenchmark( fit_xgb &lt;- fit(flow_list$xgb, data = baked_train), times = 50 ) 4.8.8 è¨ˆæ¸¬çµæœï¼ˆï¼“ï¼æ–‡å­—ï¼‰ bind_rows(time_rf_30, time_xgb_30) ## Warning in bind_rows_(x, .id): Unequal factor levels: coercing to character ## Warning in bind_rows_(x, .id): binding character and factor vector, coercing into ## character vector ## Warning in bind_rows_(x, .id): binding character and factor vector, coercing into ## character vector ## Unit: seconds ## expr min lq mean median ## fit_rf &lt;- fit(flow_list$rf, data = baked_train) 12.92101 13.17005 14.75011 14.36868 ## fit_xgb &lt;- fit(flow_list$xgb, data = baked_train) 58.12537 60.32577 68.51813 64.00283 ## uq max neval ## 15.53056 20.77089 50 ## 68.39914 155.76152 50 my_plot(time_rf_30, time_xgb_30, bins = 30) 4.8.9 äºˆæ¸¬çµæœï¼ˆï¼“ï¼æ–‡å­—ï¼‰ my_predict() ## $rf ## Reference ## Prediction ã‚ ã„ ã† ãˆ ãŠ ã‹ ã ã ã‘ ã“ ã• ã— ã™ ã› ã ãŸ ã¡ ã¤ ã¦ ã¨ ãª ã« ã¬ ã­ ã® ## ã‚ 25 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã„ 0 27 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã† 0 0 29 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ãˆ 0 0 0 22 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ãŠ 0 0 0 0 22 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã‹ 0 0 0 0 0 27 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã 0 0 0 0 0 0 26 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã 0 0 0 0 0 0 0 27 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã‘ 0 0 0 0 0 0 0 0 29 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã“ 0 0 0 0 0 0 0 0 0 17 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã• 0 0 0 0 0 0 0 0 0 0 25 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã— 0 0 0 0 0 0 0 0 0 0 0 16 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã™ 0 0 0 0 0 0 0 0 0 0 0 0 20 0 0 0 0 0 0 0 0 0 0 0 0 ## ã› 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 0 0 0 0 0 0 0 0 0 0 ## ã 0 0 0 0 0 0 0 0 0 0 0 0 0 0 26 0 0 0 0 0 0 0 0 0 0 ## ãŸ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 0 0 0 0 0 0 0 0 ## ã¡ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 26 0 0 0 0 0 0 0 0 ## ã¤ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 23 0 0 0 0 0 0 0 ## ã¦ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 18 0 0 0 0 0 0 ## ã¨ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 0 0 0 0 ## ãª 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 20 0 0 0 0 ## ã« 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 0 0 ## ã¬ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 19 0 0 ## ã­ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 ## ã® 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 21 ## ã¯ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã² 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ãµ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã¸ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã» 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## Reference ## Prediction ã¯ ã² ãµ ã¸ ã» ## ã‚ 0 0 0 0 0 ## ã„ 0 0 0 0 0 ## ã† 0 0 0 0 0 ## ãˆ 0 0 0 0 0 ## ãŠ 0 0 0 0 0 ## ã‹ 0 0 0 0 0 ## ã 0 0 0 0 0 ## ã 0 0 0 0 0 ## ã‘ 0 0 0 0 0 ## ã“ 0 0 0 0 0 ## ã• 0 0 0 0 0 ## ã— 0 0 0 0 0 ## ã™ 0 0 0 0 0 ## ã› 0 0 0 0 0 ## ã 0 0 0 0 0 ## ãŸ 0 0 0 0 0 ## ã¡ 0 0 0 0 0 ## ã¤ 0 0 0 0 0 ## ã¦ 0 0 0 0 0 ## ã¨ 0 0 0 0 0 ## ãª 0 0 0 0 0 ## ã« 0 0 0 0 0 ## ã¬ 0 0 0 0 0 ## ã­ 0 0 0 0 0 ## ã® 0 0 0 0 0 ## ã¯ 26 0 0 0 0 ## ã² 0 31 0 0 0 ## ãµ 0 0 25 0 0 ## ã¸ 0 0 0 22 0 ## ã» 0 0 0 0 24 ## ## $xgb ## Reference ## Prediction ã‚ ã„ ã† ãˆ ãŠ ã‹ ã ã ã‘ ã“ ã• ã— ã™ ã› ã ãŸ ã¡ ã¤ ã¦ ã¨ ãª ã« ã¬ ã­ ã® ## ã‚ 25 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã„ 0 27 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã† 0 0 29 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ãˆ 0 0 0 22 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ãŠ 0 0 0 0 22 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã‹ 0 0 0 0 0 27 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã 0 0 0 0 0 0 26 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã 0 0 0 0 0 0 0 27 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã‘ 0 0 0 0 0 0 0 0 29 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã“ 0 0 0 0 0 0 0 0 0 17 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã• 0 0 0 0 0 0 0 0 0 0 25 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã— 0 0 0 0 0 0 0 0 0 0 0 16 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã™ 0 0 0 0 0 0 0 0 0 0 0 0 20 0 0 0 0 0 0 0 0 0 0 0 0 ## ã› 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 0 0 0 0 0 0 0 0 0 0 ## ã 0 0 0 0 0 0 0 0 0 0 0 0 0 0 26 0 0 0 0 0 0 0 0 0 0 ## ãŸ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 0 0 0 0 0 0 0 0 ## ã¡ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 26 0 0 0 0 0 0 0 0 ## ã¤ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 23 0 0 0 0 0 0 0 ## ã¦ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 18 0 0 0 0 0 0 ## ã¨ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 0 0 0 0 ## ãª 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 20 0 0 0 0 ## ã« 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 0 0 ## ã¬ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 19 0 0 ## ã­ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 24 0 ## ã® 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 21 ## ã¯ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã² 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ãµ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã¸ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## ã» 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ## Reference ## Prediction ã¯ ã² ãµ ã¸ ã» ## ã‚ 0 0 0 0 0 ## ã„ 0 0 0 0 0 ## ã† 0 0 0 0 0 ## ãˆ 0 0 0 0 0 ## ãŠ 0 0 0 0 0 ## ã‹ 0 0 0 0 0 ## ã 0 0 0 0 0 ## ã 0 0 0 0 0 ## ã‘ 0 0 0 0 0 ## ã“ 0 0 0 0 0 ## ã• 0 0 0 0 0 ## ã— 0 0 0 0 0 ## ã™ 0 0 0 0 0 ## ã› 0 0 0 0 0 ## ã 0 0 0 0 0 ## ãŸ 0 0 0 0 0 ## ã¡ 0 0 0 0 0 ## ã¤ 0 0 0 0 0 ## ã¦ 0 0 0 0 0 ## ã¨ 0 0 0 0 0 ## ãª 0 0 0 0 0 ## ã« 0 0 0 0 0 ## ã¬ 0 0 0 0 0 ## ã­ 0 0 0 0 0 ## ã® 0 0 0 0 0 ## ã¯ 26 0 0 0 0 ## ã² 0 31 0 0 0 ## ãµ 0 0 25 0 0 ## ã¸ 0 0 0 22 0 ## ã» 0 0 0 0 24 "]
]
